# asc-ImageJ-DSX-Stitching-Utilities

	The default image format used by Olympus DSX microscopes is a two layer TIFF, which makes it very easy to use the images in ImageJ/Fiji.
	The TIFF header very usefully contains complete metadata on the image acquisition parameters.
	*All the macros in this repository require that the [exifReader](https://imagej.net/plugins/exif-reader.html) plugin has previously been installed.*

## Simple ImageJ/Fiji macros that make it easier to stitch image mosaics generated by Olympus DSX microscopes.

	For very large images, the DSX software only export scaled down version of assembled mosaics, so it is useful to have alternative ways of stitching very large images.
 
	Two versions of this macro are provided:
	*IJStitch_DSX_Mosaic_From_Selected_Image(new_plugin)*
	*IJStitch_DSX_Mosaic_From_Selected_Image(old_plugin)*
	They correspond to the 2 available versions (*new*  and *old*) of the Fiji stitching plugin by Preibisch et al.: Please note that the Stitching plugins available through Fiji, are based on a publication:
	Preibisch, S., Saalfeld, S., & Tomancak, P. (2009). Globally optimal stitching of tiled 3D microscopic image acquisitions. Bioinformatics, 25(11), 1463–1465. [doi:10.1093/bioinformatics/btp184](https://doi.org/10.1093/bioinformatics/btp184)	
	and the authors request citation if they are used successfully. [More information](https://imagej.net/plugins/image-stitching)
	
	A third macro
	*MIST-Stitch_DSX_Helper*
	uses the [MIST](https://pages.nist.gov/MIST/) plugin available from NIST:
	T. Blattner et. al. "A Hybrid CPU-GPU System for Stitching of Large Scale Optical Microscopy Images", 2014 International Conference on Parallel Processing, 2014 [doi: 10.1109/ICPP.2014.9](https://doi.org/10.1109/ICPP.2014.9)
	J. Chalfoun, et al. "MIST: Accurate and Scalable Microscopy Image Stitching Tool with Stage Modeling and Error Minimization". Scientific Reports. 2017;7:4988. [doi: 10.1038/s41598-017-04567-y](https://doi.org/10.1038/s41598-017-04567-y)

	The macros use default parameters that work well with typical images acquired at the Applied Superconductivity Center, but you will probable need to play around with them to optimize the stitching for other types of images.
	
### Stitch height-map from registered stitching coordinates

	The *Stitch_height-map_from_registered_stitch_coords* macro can use the tile coordinates generated above to fuse the corresponding height maps.
	The macro requires that [ImageMagick](https://imagemagick.org/) is installed in the system and will look for the most likely locations.
	For MIST global-positions files, the dsx images need to be in the same directory.
	
	
## DSX batch image and height map extraction macro

	*Convert_Active_DSX_Image_And_All_Others_in_Same_Directory_and_Extract_HMaps*
	As the name implies, uses the file location of an opened DSX image to convert all the other images and extract height maps.
	Partially based on code by [Alex Herbert and by Michael Schmid-3](http://imagej.1557.n6.nabble.com/Save-XY-coordinates-batch-filenames-td3697141.html)
	and structured after the ImageJ [BatchProcessFolders example macro](https://imagej.net/macros/BatchProcessFolders.txt)
	For height map extraction, the macro requires that [ImageMagick](https://imagemagick.org/) is installed in the system and will look for the most likely locations.
	